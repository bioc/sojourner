<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>densityMaskTracks — densityMaskTracks • sojourner</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="densityMaskTracks — densityMaskTracks" />

<meta property="og:description" content="mask track lists and lists of track lists using kernel density 
clusters" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sojourner</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sojourner-vignette.html">Sojourner: an R package for statistical analysis of single molecule trajectories</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sheng-liu/sojourner">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>densityMaskTracks</h1>
    <small class="dont-index">Source: <a href='https://github.com/sheng-liu/sojourner/blob/master/R/densityMaskTracks.R'><code>R/densityMaskTracks.R</code></a></small>
    <div class="hidden name"><code>densityMaskTracks-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>mask track lists and lists of track lists using kernel density 
clusters</p>
    
    </div>

    <pre class="usage"><span class='fu'>densityMaskTracks</span>(<span class='no'>trackll</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>128</span>, <span class='kw'>removeEdge</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>separate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>buildModel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>plotLines</span>(<span class='no'>trackll</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>128</span>)
<span class='fu'>plotLinesTrackl</span>(<span class='no'>track.list</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>128</span>)
<span class='fu'>plotPoints</span>(<span class='no'>trackll</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>128</span>)
<span class='fu'>plotPointsTrackl</span>(<span class='no'>track.list</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>128</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>track.list</th>
      <td><p>Track list</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>X and Y scale (in pixels) of track video window</p></td>
    </tr>
    <tr>
      <th>trackll</th>
      <td><p>An uncensored/unfiltered list of track lists</p></td>
    </tr>
    <tr>
      <th>removeEdge</th>
      <td><p>Remove edge clusters with incomplete contour 
lines/ploygons</p></td>
    </tr>
    <tr>
      <th>separate</th>
      <td><p>Separate by cluster</p></td>
    </tr>
    <tr>
      <th>buildModel</th>
      <td><p>Manually configure the kernel density probability (p), 
while continuously building a model. T to create a model or improve an 
existing model. F to load in a MODEL.csv for automatic masking.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>masked trackll</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This algorithm relies on one parameter, the kernel density probability (p),
to mask track lists. Following, describes a method to optimize a workflow to
predict p actively.</p>
<p>When densityMaskTracks() is called with buildModel = TRUE, it will 
repeatedly ask the user for the kernel density probability (p) and the 
number of smallest clusters to elimnate. The kernel density probability (p) 
is a factor that determines the cluster contours density. Low p creates
smaller and/or fewer clusters and vice versa. Adjust p accordingly, but if
there are still small extra clusters made in undesired areas, raise the
number of smallest clusters to eliminate accordingly (note: sometimes noise
clusters are too small to see). Manual input will get progressively easier
after 3 data points as the model is continuously being improved and applied.
Building the model will create a MODEL.csv in the working directory that can
be used to mask automatically if buildModel = FALSE (this will look for one
MODEL.csv in the working directory).</p>
<p>The separate parameter allows users to separate each track list from one
video into their cluster components, creating a list of track lists. 
Applying this separate parameter to a list of track lists from multiple
videos will simply append all the separated clusters together. Each track
list is named "c#" as the header. The # indicating the cluster number.</p>
<p>The removeEdge parameter allwos users to automatically remove any clusters
that are on edges and/or have an incomplete contour line (discontinuous
polgon)</p>
<p>Use plotPoints and plotLines to plot lists of track lists into
separate scatter/line plots. Use plotPointsTrackl and plotLinesTrackl for a
single track list. These track lists can be plotted at any point in
analysis.</p>
<p>EXTRA:</p>
<p>The general method for creating a masked track list from a single track list
begins by first calculating its kernel density using kernelDensity(), 
creating the mask using this value createMask() (while adjusting the kernel
density probability [p] as needed), then generating the masked track list
using applyMask. The reason why these three steps are separated in the
source code is to allow for quick repeated adjustments to the kernel density
probability (p), as the other two steps can take more time.</p>
<p>The value for the kernel density probability (p) is automatically calculated
by default using a regression model estimating the approximate desired
probability using the track list's average track length (derived from a
specific data set).Thus, it is highly recommended to use
uncensored/unfiltered track lists.</p>
<p>If one had to apply this function to a large number of typically unvariable
track lists, a regression model can be made and integrated into the source
code.</p>
    <p>when building initial masking model, MODEL.csv will be created in the
working directory (this can be renamed as long as it ends with MODEL.csv).
Each time the model is improved, the manual input will get progressively
easier. The output will be a masked trackll that is created exactly as set
during the program.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># create trackll </span>
<span class='no'>track.folder</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata"</span>,<span class='st'>"SWR1"</span>,<span class='kw'>package</span><span class='kw'>=</span><span class='st'>"sojourner"</span>)
<span class='no'>trackll</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='createTrackll-methods.html'>createTrackll</a></span>(<span class='kw'>folder</span><span class='kw'>=</span><span class='no'>track.folder</span>, <span class='kw'>input</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='output co'>#&gt; 
#&gt; Reading ParticleTracker file:  SWR1_WT_140mW_image6.csv ...
#&gt; 
#&gt;  mage6 read and processed.
#&gt; 
#&gt; Process complete.</div><div class='input'>
<span class='co'># mask trackll using using default model (may not fit all data)</span>
<span class='no'>trackll.masked</span><span class='kw'>=</span><span class='fu'>densityMaskTracks</span>(<span class='no'>trackll</span>)</div><div class='output co'>#&gt; 
#&gt;  Masking mage6 ...
#&gt; 
#&gt; No initial model read. If desired, ensure there is one file ending in MODEL.csv in working directory.</div><div class='output co'>#&gt; 
#&gt;  2 clusters. mage6 masked at kernel density probability = 0.5 , eliminate = 0 
#&gt; 
#&gt;  Masked track list for mage6 created.
#&gt; 
#&gt; All tracks lists masked.</div><div class='input'>
<span class='co'># plot to see the masking effect</span>
<span class='fu'><a href='plotTrack-methods.html'>plotTrackOverlay</a></span>(<span class='no'>trackll</span>)</div><div class='output co'>#&gt; 
#&gt; Processing SWR1_WT_140mW_image6.csv
#&gt; Output combined plot...</div><div class='img'><img src='densityMaskTracks-methods-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; Done!</div><div class='input'><span class='fu'><a href='plotTrack-methods.html'>plotTrackOverlay</a></span>(<span class='no'>trackll.masked</span>)</div><div class='output co'>#&gt; 
#&gt; Processing SWR1_WT_140mW_image6.csv
#&gt; Output combined plot...</div><div class='output co'>#&gt; 
#&gt; Done!</div><div class='input'>
# create trackll by build model manually, useful when default model does not
# yield good masking either too strigent or too lose
###trackll.masked.md <- densityMaskTracks(trackll, buildModel = TRUE)

# model building is recommended for new dataset, currently one needs to
# manually evaluate the goodness of the masking, and strength /lose it by
# specifying p value when prompted by the command.

# This is an example of masking model building process

# Masking mage6 ...
# No initial model read. If desired, ensure there is one file ending in
# MODEL.csv in working directory.
# 2 clusters. mage6 masked at kernel density probability = 0.5, 
# eliminate = 0 

# Done (1 = YES; 0 = NO)?: 0 # assume too strigent answer no. 
# New kernel density probability (p): 0.6 # assume too strigent, 
# losen it to 0.6 
# Number of smallest clusters to elimnate (recommended 0, 
# unless last resort): 0 as recommended

# 2 clusters. mage6 masked at kernel density probability = 0.6,
# eliminate = 0 
# Done (1 = YES; 0 = NO)?: 1 # yes. 

# New MODEL.csv created.
# Masked track list for mage6 created.
# All tracks lists masked.

# compare results
###plotTrackOverlay(trackll) # original
###plotTrackOverlay(trackll.masked) # masked using default masking model
###plotTrackOverlay(trackll.masked.md) # masked using losened up masking 
# model 

# now one can used this modified Model.csv to process data that was not
# masked well using default model by simply putting Model.csv in the working
# directory and set buildModel=FALSE
###trackll.masked2 <- densityMaskTracks(trackll, buildModel = FALSE)
###plotTrackOverlay(trackll.masked.md) # masked by building new (lossen up) 
# model
###plotTrackOverlay(trackll.masked2) # masked using provided (lossen up) 
# model without building it
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sheng Liu, Sun Jay Yoo, Xiao Na Tang, Young Soo Sung, Carl Wu, Sojourner Developer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

